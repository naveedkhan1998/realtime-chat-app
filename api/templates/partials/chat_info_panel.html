<!-- Chat Info Panel -->
<div class="p-4">
    <!-- Header -->
    <div class="flex items-center justify-between mb-6">
        <h3 class="font-semibold text-lg">Chat Info</h3>
        <button @click="showInfo = false" class="p-1 hover:bg-gray-100 dark:hover:bg-gray-700 rounded">
            <i data-lucide="x" class="w-5 h-5"></i>
        </button>
    </div>
    
    <!-- Room Info -->
    <div class="text-center mb-6">
        {% if room.is_group_chat %}
        <div class="w-20 h-20 rounded-full bg-gradient-to-br from-purple-500 to-pink-500 flex items-center justify-center mx-auto mb-3">
            <i data-lucide="users" class="w-10 h-10 text-white"></i>
        </div>
        <h4 class="font-semibold text-lg">{{ room.name|default:"Group Chat" }}</h4>
        <p class="text-sm text-gray-500 dark:text-gray-400">{{ room.participants.count }} members</p>
        {% else %}
        {% with other=room.other_participant %}
        {% if other.avatar %}
        <img src="{{ other.avatar.url }}" alt="{{ other.name }}" class="w-20 h-20 rounded-full object-cover mx-auto mb-3">
        {% else %}
        <div class="w-20 h-20 rounded-full bg-primary-100 dark:bg-primary-900 flex items-center justify-center mx-auto mb-3">
            <span class="text-primary-600 dark:text-primary-400 text-2xl font-semibold">
                {{ other.name|slice:":1"|upper }}
            </span>
        </div>
        {% endif %}
        <h4 class="font-semibold text-lg">{{ other.name }}</h4>
        <p class="text-sm text-gray-500 dark:text-gray-400">{{ other.email }}</p>
        {% endwith %}
        {% endif %}
    </div>
    
    <!-- Actions -->
    <div class="space-y-2 mb-6">
        <button class="w-full flex items-center gap-3 px-4 py-2 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-lg transition-colors">
            <i data-lucide="bell" class="w-5 h-5 text-gray-500"></i>
            <span>Notifications</span>
            <span class="ml-auto text-sm text-gray-500">On</span>
        </button>
        <button class="w-full flex items-center gap-3 px-4 py-2 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-lg transition-colors">
            <i data-lucide="search" class="w-5 h-5 text-gray-500"></i>
            <span>Search in conversation</span>
        </button>
    </div>
    
    <!-- Participants (for group chats) -->
    {% if room.is_group_chat %}
    <div class="mb-6">
        <h5 class="text-sm font-semibold text-gray-500 dark:text-gray-400 uppercase tracking-wider mb-3">
            Participants
        </h5>
        <div class="space-y-2">
            {% for participant in room.chatroomparticipant_set.all %}
            <div class="flex items-center gap-3 px-2 py-2 rounded-lg hover:bg-gray-100 dark:hover:bg-gray-700">
                {% if participant.user.avatar %}
                <img src="{{ participant.user.avatar.url }}" alt="{{ participant.user.name }}" class="w-8 h-8 rounded-full object-cover">
                {% else %}
                <div class="w-8 h-8 rounded-full bg-gray-200 dark:bg-gray-600 flex items-center justify-center">
                    <span class="text-gray-600 dark:text-gray-300 text-sm font-semibold">
                        {{ participant.user.name|slice:":1"|upper }}
                    </span>
                </div>
                {% endif %}
                <div class="flex-1 min-w-0">
                    <p class="text-sm font-medium truncate">
                        {{ participant.user.name }}
                        {% if participant.user == user %}
                        <span class="text-gray-500">(you)</span>
                        {% endif %}
                    </p>
                </div>
                {% if participant.user.id in online_users %}
                <span class="w-2 h-2 bg-green-500 rounded-full"></span>
                {% endif %}
            </div>
            {% endfor %}
        </div>
    </div>
    {% endif %}
    
    <!-- Collaborative Notes -->
    <div class="mb-6">
        <h5 class="text-sm font-semibold text-gray-500 dark:text-gray-400 uppercase tracking-wider mb-3">
            Shared Notes
        </h5>
        <textarea id="collaborative-note"
                  x-data="{ content: '' }"
                  x-init="content = '{{ collaborative_note|default:''|escapejs }}'"
                  x-model="content"
                  @input.debounce.500ms="if (window.chatSocket) window.chatSocket.updateNote({{ room.id }}, content)"
                  rows="4"
                  placeholder="Add notes here... (shared with all participants)"
                  class="w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-900 dark:text-white text-sm resize-none focus:ring-2 focus:ring-primary-500 focus:border-transparent"></textarea>
    </div>
    
    <!-- Shared Media -->
    <div class="mb-6">
        <h5 class="text-sm font-semibold text-gray-500 dark:text-gray-400 uppercase tracking-wider mb-3">
            Shared Media
        </h5>
        <div id="shared-media" 
             hx-get="{% url 'htmx:shared_media' room.id %}"
             hx-trigger="load"
             class="grid grid-cols-3 gap-2">
            <!-- Media thumbnails will be loaded here -->
        </div>
    </div>
    
    <!-- Danger Zone -->
    <div class="pt-4 border-t border-gray-200 dark:border-gray-700">
        {% if room.is_group_chat %}
        <button class="w-full flex items-center gap-3 px-4 py-2 text-red-600 hover:bg-red-50 dark:hover:bg-red-900/20 rounded-lg transition-colors">
            <i data-lucide="log-out" class="w-5 h-5"></i>
            <span>Leave Group</span>
        </button>
        {% else %}
        <button class="w-full flex items-center gap-3 px-4 py-2 text-red-600 hover:bg-red-50 dark:hover:bg-red-900/20 rounded-lg transition-colors"
                hx-delete="{% url 'htmx:delete_chat' room.id %}"
                hx-confirm="Are you sure you want to delete this conversation? This action cannot be undone.">
            <i data-lucide="trash-2" class="w-5 h-5"></i>
            <span>Delete Conversation</span>
        </button>
        {% endif %}
    </div>
</div>
